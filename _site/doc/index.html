<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.27
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-Thermal+Bridging+-26+Derating+-28TBD-29">Thermal Bridging &amp; Derating (TBD)</h1>

<p>… is an <a href="https://nrel.github.io/OpenStudio-user-documentation/reference/measure_writing_guide/">OpenStudio Measure</a> that first auto-detects <em>major</em> thermal bridges (like balconies, parapets and corners) in an OpenStudio model (.osm), and then <em>derates</em> outside-facing, opaque surface constructions (walls, roofs and exposed floors). It relies on both the <a href="https://openstudio-sdk-documentation.s3.amazonaws.com/index.html">OpenStudio SDK</a> and the AutomaticMagic <a href="https://github.com/automaticmagic/topolys">Topolys</a> gem.</p>

<h2 id="label-Guide+-26+Downloads">Guide &amp; Downloads</h2>

<p>Building professionals and energy modellers are encouraged to first consult the online <a href="https://rd2.github.io/tbd/">Guide</a> - it provides an overview of the underlying theory, references, workflows, etc. Users can download the latest <em>TBD</em> version directly from the Guide itself, or under <a href="https://github.com/rd2/tbd/releases">releases</a>, or via NREL&#39;s <a href="https://bcl.nrel.gov">BCL</a> … search for “bridging” or “rd2”.</p>

<p>Questions can be posted on <a href="https://unmethours.com">UnmetHours</a> - a very useful online resource for OpenStudio users.</p>

<p>TBD is also available as a Ruby gem (something along these <a href="https://github.com/automaticmagic/topolys#installation">lines</a> - TO DO).</p>

<h2 id="label-New+Features">New Features</h2>

<p>Upcoming enhancements are in the works. Bugs and new feature requests for <em>TBD</em> should be submitted <a href="https://github.com/rd2/tbd/issues">here</a>, while those more closely linked to <em>Topolys</em> should be submitted <a href="https://github.com/automaticmagic/topolys/issues">here</a>.</p>

<h2 id="label-Development">Development</h2>

<p>The installation and testing instructions in this section are for developers interested in exploring/tweaking a cloned/forked version of the source code.</p>

<p>TBD is systematically tested against updated OpenStudio versions (since v2.9.1). The following instructions refer to OpenStudio v3.2.1 (requiring Ruby v2.7.2), strictly as an example. Adapt the instructions for more recent versions - see OpenStudio&#39;s <a href="https://github.com/NREL/OpenStudio/wiki/OpenStudio-SDK-Version-Compatibility-Matrix">compatibility matrix</a>.</p>

<h3 id="label-Windows+Installation">Windows Installation</h3>

<p>Install Ruby using the <a href="https://rubyinstaller.org/downloads/archives/">RubyInstaller</a> for <a href="https://github.com/oneclick/rubyinstaller2/releases/tag/RubyInstaller-2.7.2-1/rubyinstaller-2.7.2-1-x64.exe">Ruby 2.7.2 (x64)</a>.</p>

<p>From the command line, check that the ruby installation returns the correct Ruby version: <code> ruby -v </code></p>

<p>Install bundler: <code> gem install bundler -v 2.1 </code></p>

<p>Install the OpenStudio SDK <a href="https://github.com/NREL/OpenStudio/releases/tag/v3.2.1">3.2.1</a>.</p>

<p>Create a new file <code>C:\Ruby27-x64\lib\ruby\site_ruby\openstudio.rb</code> (path may be different depending on the environment), and edit it so it <em>points</em> to your new OpenStudio installation:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>C:\openstudio-3.2.1\Ruby\openstudio.rb</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>Verify your OpenStudio and Ruby configuration: <code> ruby -e &quot;require &#39;openstudio&#39;&quot; -e &quot;puts OpenStudio::Model::Model.new&quot; </code></p>

<p>Run basic tests to ensure the measure operates properly (see end of this README).</p>

<h3 id="label-MacOS+Installation">MacOS Installation</h3>

<p>MacOS already comes with Ruby, but maybe not the right Ruby version for the desired OpenStudio measure development <a href="https://github.com/NREL/OpenStudio/wiki/OpenStudio-SDK-Version-Compatibility-Matrix">environment</a>. Instructions here show how to install Ruby v2.7.2 alongside MacOS&#39;s own Ruby version. An OpenStudio v2.9.1 setup is described <a href="https://github.com/rd2/tbd/blob/master/v291_MacOS.md">here</a>.</p>

<p>From a Terminal, install <a href="https://brew.sh/index">Homebrew</a> - nice for package distribution and management. Using Homebrew, install <em>rbenv</em> (which allows users to manage multiple Ruby versions) and finally Ruby:</p>

<pre class="code ruby"><code class="ruby">brew install rbenv
rbenv init
rbenv install 2.7.2
</code></pre>

<p>Install <a href="https://bundler.io">bundler</a>, great for managing Ruby gems and dependencies:</p>

<pre class="code ruby"><code class="ruby">gem install bundler -v 2.1
</code></pre>

<p>In the Terminal, check the Ruby version:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_ruby'>ruby</span> <span class='op'>-</span><span class='id identifier rubyid_v'>v</span>
</code></pre>

<p>… should still report the current Ruby version used by MacOS. To ensure the right version is used for developing OpenStudio Measures, instruct <em>rbenv</em> to switch Ruby version <em>locally</em> within a user’s chosen directory (e.g. “sandbox321”):</p>

<pre class="code ruby"><code class="ruby">mkdir ~/Documents/sandbox321
cd ~/Documents/sandbox321
rbenv local 2.7.2
ruby -v
</code></pre>

<p>… should report the desired <em>local</em> Ruby version, to be used by default for anything under the “sandbox321” directory tree. To ensure both Ruby versions are operational and safe, run the following checkup twice - once from a user’s home (or ~/), then from within e.g., “sandbox321”:</p>

<pre class="code ruby"><code class="ruby">cd ~/
ruby -ropen-uri -e &#39;eval URI.open(&quot;https://git.io/vQhWq&quot;).read&#39;
cd ~/Documents/sandbox321
ruby -ropen-uri -e &#39;eval URI.open(&quot;https://git.io/vQhWq&quot;).read&#39;
</code></pre>

<p>If successful, one should get a <code>Hooray!</code> from both Ruby versions confirming valid communication with <a href="https://rubygems.org/">Rubygems</a>.</p>

<p>Install the OpenStudio SDK <a href="https://github.com/NREL/OpenStudio/releases/tag/v3.2.1">3.2.1</a>.</p>

<p>Create a new file <code>~/.rbenv/versions/2.7.2/lib/ruby/site_ruby/openstudio.rb</code> (path may be different depending on the environment), and edit it so it <em>points</em> to your new OpenStudio installation:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/Applications/OpenStudio-3.2.1/Ruby/openstudio.rb</span><span class='tstring_end'>&#39;</span></span>
</code></pre>

<p>Verify your local OpenStudio and Ruby configuration:</p>

<pre class="code ruby"><code class="ruby">cd ~/Documents/sandbox321
ruby -e &quot;require &#39;openstudio&#39;&quot; -e &quot;puts OpenStudio::Model::Model.new&quot;
</code></pre>

<p>Install the latest version of <em>git</em> (e.g. through Homebrew), and <code>git clone</code> the TBD measure e.g., under “sandbox321”.</p>

<p>Run the basic tests below to ensure the measure operates as expected.</p>

<h2 id="label-Complete+list+of+test+commands">Complete list of test commands</h2>

<p>Run the following (basic) tests in the root repository of the cloned TBD measure: <code> bundle update bundle exec rake update_library_files bundle exec rake </code></p>

<p>For more extensive testing, run the following test suites (also in the root repository of the cloned TBD measure): <code> bundle update bundle exec rake osm_suite:clean bundle exec rake osm_suite:run bundle exec rake prototype_suite:clean bundle exec rake prototype_suite:run </code></p>

<p>Or run all test suites:</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_bundle'>bundle</span> <span class='id identifier rubyid_update'>update</span>
<span class='id identifier rubyid_bundle'>bundle</span> <span class='id identifier rubyid_exec'>exec</span> <span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_suites_clean'>suites_clean</span>
<span class='id identifier rubyid_bundle'>bundle</span> <span class='id identifier rubyid_exec'>exec</span> <span class='id identifier rubyid_rake'>rake</span> <span class='id identifier rubyid_suites_run'>suites_run</span>
</code></pre>

<h2 id="label-Run+tests+using+Docker+-+optional">Run tests using Docker - <em>optional</em></h2>

<p>Install <a href="https://docs.docker.com/desktop/#download-and-install">Docker</a>.</p>

<p>Pull the OpenStudio v3.2.1 Docker image: <code> docker pull nrel/openstudio:3.2.1 </code></p>

<p>In the root repository: <code> docker run --name test --rm -d -t -v ${PWD}:/work -w /work nrel/openstudio:3.2.1 docker exec -t test bundle update docker exec -t test bundle exec rake update_library_files docker exec -t test bundle exec rake docker kill test </code></p>

<h2 id="label-Support">Support</h2>

<p><em>Merci !</em> to the following organizations</p>

<p><a href="https://transitionenergetique.gouv.qc.ca"><img src="https://github.com/rd2/tbd/blob/master/sponsors/quebec.png"></a> <a href="https://nrc.canada.ca/en/research-development/research-collaboration/research-centres/construction-research-centre"><img src="https://github.com/rd2/tbd/blob/master/sponsors/canada.png"></a></p>
</div></div>

      <div id="footer">
  Generated on Mon Dec 13 12:13:54 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.27 (ruby-2.7.2).
</div>

    </div>
  </body>
</html>